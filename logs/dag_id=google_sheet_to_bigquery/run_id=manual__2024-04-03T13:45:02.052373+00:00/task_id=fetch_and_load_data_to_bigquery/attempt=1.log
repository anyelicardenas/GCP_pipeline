[2024-04-03T13:45:05.778+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: google_sheet_to_bigquery.fetch_and_load_data_to_bigquery manual__2024-04-03T13:45:02.052373+00:00 [queued]>
[2024-04-03T13:45:05.788+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: google_sheet_to_bigquery.fetch_and_load_data_to_bigquery manual__2024-04-03T13:45:02.052373+00:00 [queued]>
[2024-04-03T13:45:05.789+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 2
[2024-04-03T13:45:05.809+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): fetch_and_load_data_to_bigquery> on 2024-04-03 13:45:02.052373+00:00
[2024-04-03T13:45:05.817+0000] {standard_task_runner.py:60} INFO - Started process 7409 to run task
[2024-04-03T13:45:05.822+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'google_sheet_to_bigquery', 'fetch_and_load_data_to_bigquery', 'manual__2024-04-03T13:45:02.052373+00:00', '--job-id', '113', '--raw', '--subdir', 'DAGS_FOLDER/dags/habidag.py', '--cfg-path', '/tmp/tmpieg75itp']
[2024-04-03T13:45:05.824+0000] {standard_task_runner.py:88} INFO - Job 113: Subtask fetch_and_load_data_to_bigquery
[2024-04-03T13:45:05.891+0000] {task_command.py:423} INFO - Running <TaskInstance: google_sheet_to_bigquery.fetch_and_load_data_to_bigquery manual__2024-04-03T13:45:02.052373+00:00 [running]> on host 84784c125ee0
[2024-04-03T13:45:05.997+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='google_sheet_to_bigquery' AIRFLOW_CTX_TASK_ID='fetch_and_load_data_to_bigquery' AIRFLOW_CTX_EXECUTION_DATE='2024-04-03T13:45:02.052373+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-04-03T13:45:02.052373+00:00'
[2024-04-03T13:45:06.753+0000] {connection.py:269} WARNING - Connection schemes (type: google_cloud_platform) shall not contain '_' according to RFC3986.
[2024-04-03T13:45:06.761+0000] {base.py:83} INFO - Using connection ID 'google_cloud_default' for task execution.
[2024-04-03T13:45:06.763+0000] {bigquery.py:470} INFO - datasetId was not specified in `dataset_reference`. Will use default value datalake_anyeli6.
[2024-04-03T13:45:06.764+0000] {bigquery.py:470} INFO - projectId was not specified in `dataset_reference`. Will use default value papyrus-technical-test.
[2024-04-03T13:45:06.764+0000] {bigquery.py:481} INFO - Creating dataset: datalake_anyeli6 in project: papyrus-technical-test 
[2024-04-03T13:45:07.905+0000] {bigquery.py:485} INFO - Dataset created successfully.
[2024-04-03T13:45:08.304+0000] {connection.py:269} WARNING - Connection schemes (type: google_cloud_platform) shall not contain '_' according to RFC3986.
[2024-04-03T13:45:08.307+0000] {base.py:83} INFO - Using connection ID 'google_cloud_default' for task execution.
[2024-04-03T13:45:08.309+0000] {bigquery.py:1516} INFO - Creating table
[2024-04-03T13:45:09.403+0000] {bigquery.py:1538} INFO - Table papyrus-technical-test.datalake_anyeli6.transportistas created successfully
[2024-04-03T13:45:09.477+0000] {logging_mixin.py:188} INFO -    idTransportista     nombreEmpresa
0                1    Speedy Express
1                2    United Package
2                3  Federal Shipping
3                4     test cargue 1
[2024-04-03T13:45:09.483+0000] {logging_mixin.py:188} INFO - someone had an error:  transportistas 1 {'name': 'nombreEmpresa', 'type': 'STRING', 'mode': 'REQUIRED'} idTransportista                 1
nombreEmpresa      Speedy Express
Name: 0, dtype: object Speedy Express <class 'str'>
[2024-04-03T13:45:09.485+0000] {logging_mixin.py:188} INFO - someone had an error:  transportistas 1 {'name': 'nombreEmpresa', 'type': 'STRING', 'mode': 'REQUIRED'} idTransportista                 2
nombreEmpresa      United Package
Name: 1, dtype: object United Package <class 'str'>
[2024-04-03T13:45:09.488+0000] {logging_mixin.py:188} INFO - someone had an error:  transportistas 1 {'name': 'nombreEmpresa', 'type': 'STRING', 'mode': 'REQUIRED'} idTransportista                   3
nombreEmpresa      Federal Shipping
Name: 2, dtype: object Federal Shipping <class 'str'>
[2024-04-03T13:45:09.490+0000] {logging_mixin.py:188} INFO - someone had an error:  transportistas 1 {'name': 'nombreEmpresa', 'type': 'STRING', 'mode': 'REQUIRED'} idTransportista                4
nombreEmpresa      test cargue 1
Name: 3, dtype: object test cargue 1 <class 'str'>
[2024-04-03T13:45:09.492+0000] {logging_mixin.py:188} INFO - INSERT `papyrus-technical-test.datalake_anyeli6.transportistas` VALUES (1, 'Speedy Express'), (2, 'United Package'), (3, 'Federal Shipping'), (4, 'test cargue 1');
[2024-04-03T13:45:09.511+0000] {connection.py:269} WARNING - Connection schemes (type: google_cloud_platform) shall not contain '_' according to RFC3986.
[2024-04-03T13:45:09.514+0000] {base.py:83} INFO - Using connection ID 'google_cloud_default' for task execution.
[2024-04-03T13:45:09.684+0000] {bigquery.py:2811} INFO - Executing: {'query': {'query': "INSERT `papyrus-technical-test.datalake_anyeli6.transportistas` VALUES (1, 'Speedy Express'), (2, 'United Package'), (3, 'Federal Shipping'), (4, 'test cargue 1');", 'useLegacySql': False, 'priority': 'BATCH'}}'
[2024-04-03T13:45:09.685+0000] {bigquery.py:1613} INFO - Inserting job ***_adhoc_***_insert_data_transportistas_2024_04_03T13_45_02_052373_00_00_0977653cad45a9908a1ffa53bb9d7e98
[2024-04-03T13:45:13.114+0000] {connection.py:269} WARNING - Connection schemes (type: google_cloud_platform) shall not contain '_' according to RFC3986.
[2024-04-03T13:45:13.122+0000] {base.py:83} INFO - Using connection ID 'google_cloud_default' for task execution.
[2024-04-03T13:45:13.123+0000] {bigquery.py:1516} INFO - Creating table
[2024-04-03T13:45:14.273+0000] {bigquery.py:1538} INFO - Table papyrus-technical-test.datalake_anyeli6.categorias created successfully
[2024-04-03T13:45:14.298+0000] {logging_mixin.py:188} INFO -    idCategoria  ...                                        descripcion
0            1  ...        Soft drinks, coffees, teas, beers, and ales
1            2  ...  Sweet and savory sauces, relishes, spreads, an...
2            3  ...                Desserts, candies, and sweet breads
3            4  ...                                            Cheeses
4            5  ...                Breads, crackers, pasta, and cereal
5            6  ...                                     Prepared meats
6            7  ...                          Dried fruit and bean curd
7            8  ...                                   Seaweed and fish

[8 rows x 3 columns]
[2024-04-03T13:45:14.300+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 1 {'name': 'nombreCategoria', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                                                  1
nombreCategoria                                      Beverages
descripcion        Soft drinks, coffees, teas, beers, and ales
Name: 0, dtype: object Beverages <class 'str'>
[2024-04-03T13:45:14.301+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 2 {'name': 'descripcion', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                                                  1
nombreCategoria                                      Beverages
descripcion        Soft drinks, coffees, teas, beers, and ales
Name: 0, dtype: object Soft drinks, coffees, teas, beers, and ales <class 'str'>
[2024-04-03T13:45:14.303+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 1 {'name': 'nombreCategoria', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                                                        2
nombreCategoria                                           Condiments
descripcion        Sweet and savory sauces, relishes, spreads, an...
Name: 1, dtype: object Condiments <class 'str'>
[2024-04-03T13:45:14.304+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 2 {'name': 'descripcion', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                                                        2
nombreCategoria                                           Condiments
descripcion        Sweet and savory sauces, relishes, spreads, an...
Name: 1, dtype: object Sweet and savory sauces, relishes, spreads, and seasonings <class 'str'>
[2024-04-03T13:45:14.305+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 1 {'name': 'nombreCategoria', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                                          3
nombreCategoria                            Confections
descripcion        Desserts, candies, and sweet breads
Name: 2, dtype: object Confections <class 'str'>
[2024-04-03T13:45:14.307+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 2 {'name': 'descripcion', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                                          3
nombreCategoria                            Confections
descripcion        Desserts, candies, and sweet breads
Name: 2, dtype: object Desserts, candies, and sweet breads <class 'str'>
[2024-04-03T13:45:14.308+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 1 {'name': 'nombreCategoria', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                     4
nombreCategoria    Dairy Products
descripcion               Cheeses
Name: 3, dtype: object Dairy Products <class 'str'>
[2024-04-03T13:45:14.310+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 2 {'name': 'descripcion', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                     4
nombreCategoria    Dairy Products
descripcion               Cheeses
Name: 3, dtype: object Cheeses <class 'str'>
[2024-04-03T13:45:14.311+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 1 {'name': 'nombreCategoria', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                                          5
nombreCategoria                       Grains & Cereals
descripcion        Breads, crackers, pasta, and cereal
Name: 4, dtype: object Grains & Cereals <class 'str'>
[2024-04-03T13:45:14.313+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 2 {'name': 'descripcion', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                                          5
nombreCategoria                       Grains & Cereals
descripcion        Breads, crackers, pasta, and cereal
Name: 4, dtype: object Breads, crackers, pasta, and cereal <class 'str'>
[2024-04-03T13:45:14.314+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 1 {'name': 'nombreCategoria', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                     6
nombreCategoria    Meat & Poultry
descripcion        Prepared meats
Name: 5, dtype: object Meat & Poultry <class 'str'>
[2024-04-03T13:45:14.315+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 2 {'name': 'descripcion', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                     6
nombreCategoria    Meat & Poultry
descripcion        Prepared meats
Name: 5, dtype: object Prepared meats <class 'str'>
[2024-04-03T13:45:14.317+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 1 {'name': 'nombreCategoria', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                                7
nombreCategoria                      Produce
descripcion        Dried fruit and bean curd
Name: 6, dtype: object Produce <class 'str'>
[2024-04-03T13:45:14.318+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 2 {'name': 'descripcion', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                                7
nombreCategoria                      Produce
descripcion        Dried fruit and bean curd
Name: 6, dtype: object Dried fruit and bean curd <class 'str'>
[2024-04-03T13:45:14.319+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 1 {'name': 'nombreCategoria', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                       8
nombreCategoria             Seafood
descripcion        Seaweed and fish
Name: 7, dtype: object Seafood <class 'str'>
[2024-04-03T13:45:14.321+0000] {logging_mixin.py:188} INFO - someone had an error:  categorias 2 {'name': 'descripcion', 'type': 'STRING', 'mode': 'REQUIRED'} idCategoria                       8
nombreCategoria             Seafood
descripcion        Seaweed and fish
Name: 7, dtype: object Seaweed and fish <class 'str'>
[2024-04-03T13:45:14.322+0000] {logging_mixin.py:188} INFO - INSERT `papyrus-technical-test.datalake_anyeli6.categorias` VALUES (1, 'Beverages', 'Soft drinks, coffees, teas, beers, and ales'), (2, 'Condiments', 'Sweet and savory sauces, relishes, spreads, and seasonings'), (3, 'Confections', 'Desserts, candies, and sweet breads'), (4, 'Dairy Products', 'Cheeses'), (5, 'Grains & Cereals', 'Breads, crackers, pasta, and cereal'), (6, 'Meat & Poultry', 'Prepared meats'), (7, 'Produce', 'Dried fruit and bean curd'), (8, 'Seafood', 'Seaweed and fish');
[2024-04-03T13:45:14.329+0000] {connection.py:269} WARNING - Connection schemes (type: google_cloud_platform) shall not contain '_' according to RFC3986.
[2024-04-03T13:45:14.332+0000] {base.py:83} INFO - Using connection ID 'google_cloud_default' for task execution.
[2024-04-03T13:45:14.376+0000] {bigquery.py:2811} INFO - Executing: {'query': {'query': "INSERT `papyrus-technical-test.datalake_anyeli6.categorias` VALUES (1, 'Beverages', 'Soft drinks, coffees, teas, beers, and ales'), (2, 'Condiments', 'Sweet and savory sauces, relishes, spreads, and seasonings'), (3, 'Confections', 'Desserts, candies, and sweet breads'), (4, 'Dairy Products', 'Cheeses'), (5, 'Grains & Cereals', 'Breads, crackers, pasta, and cereal'), (6, 'Meat & Poultry', 'Prepared meats'), (7, 'Produce', 'Dried fruit and bean curd'), (8, 'Seafood', 'Seaweed and fish');", 'useLegacySql': False, 'priority': 'BATCH'}}'
[2024-04-03T13:45:14.377+0000] {bigquery.py:1613} INFO - Inserting job ***_adhoc_***_insert_data_categorias_2024_04_03T13_45_02_052373_00_00_7dafc7bad23d55024eacee4b56b8f925
[2024-04-03T13:45:19.149+0000] {connection.py:269} WARNING - Connection schemes (type: google_cloud_platform) shall not contain '_' according to RFC3986.
[2024-04-03T13:45:19.157+0000] {base.py:83} INFO - Using connection ID 'google_cloud_default' for task execution.
[2024-04-03T13:45:19.162+0000] {bigquery.py:1516} INFO - Creating table
[2024-04-03T13:45:20.728+0000] {bigquery.py:1538} INFO - Table papyrus-technical-test.datalake_anyeli6.pedidos created successfully
[2024-04-03T13:45:20.799+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dags/habidag.py", line 99, in fetch_and_load_data_to_bigquery
    df[columns["name"]] = df[columns["name"]].astype(float)
NameError: name 'columns' is not defined
[2024-04-03T13:45:20.872+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=google_sheet_to_bigquery, task_id=fetch_and_load_data_to_bigquery, execution_date=20240403T134502, start_date=20240403T134505, end_date=20240403T134520
[2024-04-03T13:45:20.925+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 113 for task fetch_and_load_data_to_bigquery (name 'columns' is not defined; 7409)
[2024-04-03T13:45:21.078+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-04-03T13:45:21.170+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
